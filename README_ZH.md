# web_server

一个跨平台的 Flutter/Dart 局域网文件共享服务器，支持文件/文件夹的上传、下载、删除和浏览。适用于桌面、移动端和嵌入式设备，轻松实现本地文件的 Web 访问与管理。

## 特性

- 📁 **文件/文件夹上传**：支持多文件、多层级目录上传
- 📥 **文件/文件夹下载**：支持大文件、目录自动打包为 zip 并流式下载
- 🗑️ **文件/文件夹删除**：一键删除共享目录下的内容
- 🖥️ **跨平台支持**：可运行于 Windows、macOS、Linux、Android、iOS
- 🌐 **Web UI 友好**：内置美观的网页端，支持拖拽上传、文件浏览
- 📝 **在线文本编辑**：可直接在网页中预览、编辑、保存 txt/json/yaml 等文本文件
- 🧹 **JSON 智能工具**：一键格式化、实时校验、错误行号高亮
- 🎨 **专业编辑器体验**：语法高亮、行号、暗色主题、全屏、查找、错误高亮
- 🔒 **安全性**：路径校验防止目录穿越，支持局域网隔离
- 🚀 **高性能**：大文件/大目录流式处理，低内存占用
- 📝 **日志与状态流**：便于集成到 Flutter 应用中

## 快速开始

### 1. 安装依赖

在项目根目录下运行：

```bash
flutter pub get
```

### 2. 运行示例（桌面/移动端）

```bash
cd example
flutter run
```

### 3. 在 Dart/Flutter 项目中集成

```dart
import 'package:web_server/web_server.dart';

final server = WebServerService(port: 8080, sharedDir: '/your/shared/dir');
await server.start();
```

### 4. 访问 Web 管理页面

在浏览器中访问：

```
http://<本机IP>:8080/
```

## API 路由说明

| 路径           | 方法 | 说明                   |
|----------------|------|------------------------|
| `/`            | GET  | 首页（Web UI）         |
| `/files`       | GET  | 获取文件/文件夹列表    |
| `/upload`      | POST | 上传文件/文件夹        |
| `/download`    | GET  | 下载文件/文件夹        |
| `/delete`      | POST | 删除文件/文件夹        |
| `/save`        | POST | 保存编辑后的文本文件   |
| `/静态文件路径` | GET  | 直接访问共享目录下文件 |

- **文件夹下载**：自动打包为 zip 并流式传输，支持大目录
- **大文件下载**：支持流式传输，低内存占用
- **文本文件编辑**：网页在线编辑/保存 txt/json/yaml 等文本文件
- **JSON 编辑**：一键格式化、实时校验、错误行号高亮

## 典型使用场景

- 局域网内多设备文件互传
- 移动端与桌面端临时文件共享
- 跨平台本地文件管理
- 内网环境下的轻量级文件服务器

## 常见问题

- **Q: 如何更改共享目录？**  
  A: 创建 `WebServerService` 时指定 `sharedDir` 参数即可。

- **Q: 支持多用户并发吗？**  
  A: 支持，底层基于 Dart 异步 IO，适合轻量级并发场景。

- **Q: 大文件/大目录会卡死吗？**  
  A: 不会，采用流式处理和临时文件方案，内存占用低。

- **Q: 如何在移动端使用？**  
  A: 参考 `example` 目录，移动端自动选择应用文档目录为共享目录。

## 贡献与反馈

欢迎提 issue、PR 或建议！  
如需定制功能、发现 bug 或有更好的想法，欢迎联系作者或提交到 [GitHub Issues](https://github.com/lianleven/web_server/issues)。

---

如需更详细的开发文档或有特殊需求，请随时联系！

